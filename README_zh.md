# Flutter Gopher

[English](https://github.com/czg99/flutter_gopher/blob/main/README.md) | ä¸­æ–‡

Flutter Gopher ç”¨äºæ¡¥æ¥ Flutter ä¸ Golang åŸç”Ÿä»£ç ã€‚å¿«é€Ÿåˆ›å»ºåŸºäº Golang åŸç”Ÿçš„ Flutter æ’ä»¶ï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆ FFI ç»‘å®šä»£ç ã€‚

## âœ¨ åŠŸèƒ½ç‰¹ç‚¹

- ğŸ”„ åˆ›å»ºå®Œæ•´çš„ Flutter æ’ä»¶é¡¹ç›®ç»“æ„
- ğŸ”Œ è‡ªåŠ¨ç”Ÿæˆ Go å’Œ Dart ä¹‹é—´çš„ FFI ç»‘å®šä»£ç 
- ğŸš€ æä¾›æ— ç¼çš„ Flutter-Go äº’æ“ä½œæ€§
- ğŸ’» æ”¯æŒå¤šå¹³å°ï¼ˆiOSã€Androidã€Windowsã€macOSã€Linuxï¼‰

## ğŸ› ï¸ å®‰è£…

### å‰ç½®æ¡ä»¶

- Go 1.23.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- Flutter 3.22.0 æˆ–æ›´é«˜ç‰ˆæœ¬ 
- Zig 0.14.0 æˆ–æ›´é«˜ç‰ˆæœ¬ (ç¼–è¯‘ä¸º Windows æˆ– Linux çš„åº“éœ€è¦)

### å®‰è£…æ­¥éª¤

```bash
go install github.com/czg99/flutter_gopher/cmd/fgo@v0.1.2
```

## ğŸ“‹ ä½¿ç”¨æ–¹æ³•

Flutter Gopher æä¾›äº†ä¸¤ä¸ªä¸»è¦å‘½ä»¤ï¼š

### 1. åˆ›å»ºæ–°çš„ Flutter æ’ä»¶é¡¹ç›®

```bash
fgo create -n <é¡¹ç›®åç§°> -o <è¾“å‡ºç›®å½•> [--example]
```

**å‚æ•°è¯´æ˜ï¼š**
- `-n, --name`ï¼šæ’ä»¶é¡¹ç›®åç§°ï¼ˆå¿…éœ€ï¼‰
- `-o, --output`ï¼šç”Ÿæˆçš„æ’ä»¶é¡¹ç›®çš„è¾“å‡ºç›®å½•ï¼ˆé»˜è®¤: <é¡¹ç›®åç§°>ï¼‰
- `--example`ï¼šç”Ÿæˆä½¿ç”¨è¯¥æ’ä»¶çš„ç¤ºä¾‹ Flutter åº”ç”¨

**ç¤ºä¾‹ï¼š**
```bash
fgo create -n my_api -o ./my_api
fgo create -n payment_service --example
```

### 2. ç”Ÿæˆ Go å’Œ Dart FFI ç»‘å®šä»£ç 

```bash
cd <fgoåˆ›å»ºçš„é¡¹ç›®>
fgo generate
```

## ğŸ“ é¡¹ç›®ç»“æ„

ä½¿ç”¨ `create` å‘½ä»¤ç”Ÿæˆçš„æ’ä»¶é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š

```
my_api/
â”œâ”€â”€ android/        # Android å¹³å°ç‰¹å®šä»£ç 
â”œâ”€â”€ ios/            # iOS å¹³å°ç‰¹å®šä»£ç 
â”œâ”€â”€ linux/          # Linux å¹³å°ç‰¹å®šä»£ç 
â”œâ”€â”€ macos/          # macOS å¹³å°ç‰¹å®šä»£ç 
â”œâ”€â”€ windows/        # Windows å¹³å°ç‰¹å®šä»£ç 
â”œâ”€â”€ lib/            # Dart API ä»£ç 
â”‚   â””â”€â”€ my_api.dart
â”œâ”€â”€ src/            # Go æºä»£ç 
â”‚   â”œâ”€â”€ api/        # ç”¨æˆ·å®ç°çš„ API
â”‚   â””â”€â”€ api.go      # ç”Ÿæˆçš„ Go FFI ä»£ç 
â””â”€â”€ example/        # ç¤ºä¾‹ Flutter åº”ç”¨ï¼ˆå¦‚æœä½¿ç”¨ --example é€‰é¡¹ï¼‰
```

## ğŸ“Š æ”¯æŒçš„æ•°æ®ç±»å‹

Flutter Gopher æ”¯æŒåœ¨ Go å’Œ Dart ä¹‹é—´è½¬æ¢ä»¥ä¸‹æ•°æ®ç±»å‹ï¼š

| Go ç±»å‹                                       | Dart ç±»å‹      | è¯´æ˜                |
| --------------------------------------------- | ------------- | ------------------- |
| `bool`                                        | `bool`        | å¸ƒå°”å€¼              |
| `int8`, `int16`, `int32`, `int64`, `int`      | `int`         | æœ‰ç¬¦å·æ•´æ•°           |
| `uint8`, `uint16`, `uint32`, `uint64`, `uint` | `int`         | æ— ç¬¦å·æ•´æ•°           |
| `float32`                                     | `double`      | 32 ä½æµ®ç‚¹æ•°          |
| `float64`                                     | `double`      | 64 ä½æµ®ç‚¹æ•°          |
| `string`                                      | `String`      | å­—ç¬¦ä¸²               |
| `struct`                                      | `Class`       | ç»“æ„ä½“/ç±»            |
| `[]T`                                         | `List<T>`     | åˆ‡ç‰‡/æ•°ç»„            |
| `chan T`                                      | `FgChan<T>`   | Go åˆ° Dart çš„å•å‘é€šé“ |
| `*T`                                          | `T?`          | æŒ‡é’ˆè½¬æ¢ä¸ºå¯ç©ºç±»å‹     |
| `error`                                       | `String?`     | é”™è¯¯è½¬æ¢ä¸ºå¯ç©ºå­—ç¬¦ä¸²   |
| `func(...)`                                   | `Future<...>` | å¼‚æ­¥å‡½æ•°æ”¯æŒ          |

### ç±»å‹è½¬æ¢è§„åˆ™
 
1. **ç»“æ„ä½“**ï¼šGo ç»“æ„ä½“ä¼šç”Ÿæˆå¯¹åº”çš„ Dart ç±»ï¼Œå­—æ®µåç§°ä¼šè½¬æ¢ä¸ºé©¼å³°å¼å‘½å
2. **åˆ‡ç‰‡**ï¼šGo åˆ‡ç‰‡ä¼šè½¬æ¢ä¸º Dart çš„ `List`ï¼Œå¹¶ä¿ç•™å…ƒç´ ç±»å‹
3. **æŒ‡é’ˆ**ï¼šGo çš„æŒ‡é’ˆç±»å‹ä¼šè¢«è½¬æ¢ä¸º Dart çš„å¯ç©ºç±»å‹
4. **é€šé“**ï¼šGo çš„é€šé“ç±»å‹ä¼šè¢«è½¬æ¢ä¸º Dart çš„ `FgChan<T>`ï¼Œè°ƒç”¨listenæ–¹æ³•å¯ä»¥ç›‘å¬é€šé“æ•°æ®
5. **å¼‚æ­¥æ”¯æŒ**ï¼šæ‰€æœ‰ Go å‡½æ•°éƒ½ä¼šç”ŸæˆåŒæ­¥å’Œå¼‚æ­¥çš„ Dart æ–¹æ³•
6. **é”™è¯¯å¤„ç†**ï¼šGo å‡½æ•°è¿”å›çš„ `error`ï¼Œåœ¨ Dart ç«¯ä½œä¸ºå¼‚å¸¸æŠ›å‡ºï¼Œéœ€ä½¿ç”¨ try-catch æ•è·

## ğŸ”„ å¼€å‘æµç¨‹

1. ä½¿ç”¨ `fgo create` å‘½ä»¤åˆ›å»ºæ–°çš„æ’ä»¶é¡¹ç›®
2. åœ¨æ’ä»¶å·¥ç¨‹æ ¹ç›®å½•ä¸‹çš„ `src/api` ç›®å½•ä¸­å®ç° Go API
3. åœ¨æ’ä»¶å·¥ç¨‹æ ¹ç›®å½•ä¸­ä½¿ç”¨ `fgo generate` å‘½ä»¤é‡æ–°ç”Ÿæˆ FFI ç»‘å®šä»£ç 
4. åœ¨ Flutter é¡¹ç›®æ·»åŠ è¯¥æ’ä»¶åˆ°ä¾èµ–ä¸­

## ğŸŒŸ ç¤ºä¾‹

### åˆ›å»ºä¸€ä¸ªç®€å•çš„è®¡ç®—å™¨æ’ä»¶

#### 1. åˆ›å»ºæ’ä»¶é¡¹ç›®ï¼š

```bash
fgo create -n calculator -o ./calculator --example
```

#### 2. åœ¨ `src/api` ç›®å½•ä¸­å®ç°è®¡ç®—å™¨ APIï¼š

```go
// src/api/calculator.go
package api

func Add(a, b int) int {
    return a + b
}

```

#### 3. ç”Ÿæˆ FFI ç»‘å®šä»£ç ï¼š

```bash
cd calculator
fgo generate
```

#### 4. åœ¨ Flutter åº”ç”¨ä¸­ä½¿ç”¨è¯¥æ’ä»¶ï¼š

```dart
import 'package:calculator/calculator.dart';

void main() async {
  // ä½¿ç”¨åŒæ­¥ API
  final api = Calculator();
  final sum = api.add(5, 3);
  print('5 + 3 = $sum');
  
  // ä½¿ç”¨å¼‚æ­¥ API
  final sumAsync = await api.addGoAsync(5, 3);
  print('5 + 3 = $sumAsync');
}
```

## ğŸ“ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Pull Request æˆ–åˆ›å»º Issue æ¥å¸®åŠ©æ”¹è¿› Flutter Gopherï¼

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦æƒ…è¯·å‚é˜… [LICENSE](LICENSE) æ–‡ä»¶ã€‚